// https://github.com/fanguitocoder/cool-3d-gallery

(function(n){n.fn.C3DGallery=function(g){function C(e){var a=document.createElement("div");a.className="element";a.style.zIndex=0;a.style.backgroundColor="rgba(0,0,0,0)";var d=document.createElement("div");d.className="image";d.appendChild(e);a.appendChild(d);return a}function A(f,a){TWEEN.removeAll();for(var d=0;d<e.length;d++){var c=e[d],b=f[d];(new TWEEN.Tween(c.position)).to({x:b.position.x,y:b.position.y,z:b.position.z},Math.random()*a+a).easing(TWEEN.Easing.Exponential.InOut).start();(new TWEEN.Tween(c.rotation)).to({x:b.rotation.x,
y:b.rotation.y,z:b.rotation.z},Math.random()*a+a).easing(TWEEN.Easing.Exponential.InOut).start()}(new TWEEN.Tween(this)).to({},2*a).onUpdate(r).start()}function D(f){TWEEN.removeAll();for(var a=void 0,d=l,c=0;c<e.length;c++)if(f.id==e[c].element.id){a=e[c];break}(new TWEEN.Tween(a.rotation)).to({x:d.rotation.x+6.28,y:d.rotation.y+6.28,z:d.rotation.z+6.28},1500).easing(TWEEN.Easing.Circular.Out).start();(new TWEEN.Tween(this)).to({},500).onUpdate(function(){n(a.element).css("z-index",2E4);r()}).start()}
function E(){l.aspect=p.width()/p.height();l.updateProjectionMatrix();q.setSize(p.width(),p.height());r()}function u(){requestAnimationFrame(u);TWEEN.update();for(var f=0;f<e.length;f++){var a=l.position.distanceTo(e[f].position);n(e[f].element).css("z-index",Math.floor(2E4-a))}t.update();r()}function r(){q.render(y,l)}g=g||{};var p=this,z=g.data||{},v=g.effect||"sphere",B=g.duration||2E3,l,y,q,t,e=[],m={table:[],sphere:[],helix:[],grid:[],spiral:[],random:[]};window.objects3d=e;window.targets3d=
m;this.each(function(){this.nodeName.toLowerCase()});(function(){l=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1E4);l.position.z=3E3;y=new THREE.Scene;for(var f=0,a=0;a<z.length;a++){var d=document.createElement("img");d.onload=function(){f++;f==z.length&&A(m[v],B)};d.src=z[a].image;d=C(d);d.id="image_"+a;d.addEventListener("click",function(){D(this)});b=new THREE.CSS3DObject(d);b.position.x=4E3*Math.random()-2E3;b.position.y=4E3*Math.random()-2E3;b.position.z=4E3*Math.random()-
2E3;y.add(b);e.push(b)}for(var c=0,b,a=0;a<e.length;a++)b=new THREE.Object3D,b.position.x=a%20*140-1300,b.position.y=-(200*c)+500,m.table.push(b),0==a%20&&0!==a&&c++;for(var c=new THREE.Vector3,a=0,k=e.length;a<k;a++){var h=Math.acos(-1+2*a/k),g=Math.sqrt(k*Math.PI)*h;b=new THREE.Object3D;b.position.x=800*Math.cos(g)*Math.sin(h);b.position.y=800*Math.sin(g)*Math.sin(h);b.position.z=800*Math.cos(h);c.copy(b.position).multiplyScalar(2);b.lookAt(c);m.sphere.push(b)}c=new THREE.Vector3;new THREE.Object3D;
a=0;for(k=e.length;a<k;a++)h=.175*a+Math.PI,b=new THREE.Object3D,b.position.x=900*Math.sin(h),b.position.y=-(8*a)+450,b.position.z=900*Math.cos(h),c.x=2*b.position.x,c.y=b.position.y,c.z=2*b.position.z,b.lookAt(c),m.helix.push(b);for(a=0;a<e.length;a++)b=new THREE.Object3D,b.position.x=a%5*400-800,b.position.y=400*-(Math.floor(a/5)%5)+800,b.position.z=1E3*Math.floor(a/25)-2E3,m.grid.push(b);for(var g=h=k=0,n=!1,c=-1,w=0,x=1,u=[[140,0],[0,200],[-140,0],[0,-200]],a=0;a<e.length;a++)b=new THREE.Object3D,
k+=u[w][0]*x,h+=u[w][1]*x,b.position.x=k,b.position.y=h,m.spiral.push(b),c<g?c++:(c=0,w=(w+1)%4,n?(g++,n=!1):n=!0),x+=.005;for(a=f=0;a<e.length;a++)b=new THREE.CSS3DObject(d),b.position.x=4E3*Math.random()-2E3,b.position.y=4E3*Math.random()-2E3,b.position.z=4E3*Math.random()-2E3,m.random.push(b);q=new THREE.CSS3DRenderer;q.setSize(p.width(),p.height());q.domElement.style.position="relative";p.append(q.domElement);t=new THREE.TrackballControls(l,q.domElement);t.rotateSpeed=.5;t.minDistance=0;t.maxDistance=
16E3;t.addEventListener("change",r);window.addEventListener("keydown",function(a){if("n"==a.key&&a.altKey){a=[];var b=0,c;for(c in targets3d)a.push(c),c===v&&(b=a.length);v=a[b%a.length];A(targets3d[v],B)}},!1);r();window.addEventListener("resize",E,!1)})();u();return this}})(jQuery);
